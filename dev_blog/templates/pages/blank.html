<!DOCTYPE html>

{% load static %}


<head>
<link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    {% block head %}
    {% endblock head %}

    <link rel="stylesheet" href="{% static 'styles/blank.css' %}">
    {% block extraCSS %}
    {% endblock extraCSS %}

    <script type="text/javascript">
        function toggleOverlayVisibility(overlay)
        {
            //var overlay = document.getElementById("loginFormContainer");
            if (overlay.style.display == "") {overlay.style.display="none";}
            else {overlay.style.display = "";}
        }

        function retrieveCookies()
        {
            const cookies = document.cookie.split("; ");
            var jsonCookies = {};
            for (const cookie of cookies)
            {
                let keyValuePair = cookie.split("=");
                jsonCookies[keyValuePair[0]] = keyValuePair[1];
            }
            return jsonCookies;
        }
    </script>
</head>

<body bgcolor="blue" class="body" id="body">
    {{ username|json_script:"username" }}

    <div style="display:none" id="loginFormOverlay" class="loginFormOverlay" onclick="toggleOverlayVisibility(this)">
        <form onclick="event.stopPropagation()" id="loginForm" class="loginForm" method="POST" action="{% url 'login' %}">
            {% csrf_token %}
            <label style="float: left">username </label><br>
            <input type="text" name="username" style="padding-bottom: 2%" value=""><br>
            <label style="float:left">password </label><br>
            <input type="text" name="password" style="padding-bottom: 2%" value=""><br>
            <button type="submit">submit</button>
        </form>
    </div>


    <div class="banner"> <img src="banner.jpg">
    </div>

    <div class="page">
        <div class="pageSidebar"> </div>
        <div class="pageContent" id="pageContent" style="background-color: gray;">
            <div class="navbar">
                <div class="navbarButtonContainer">
                    <button onclick="location.href='/home'"> HOME </button>
                    <button onclick="location.href='/changelog'"> CHANGELOG </button>
                    <button> ABOUT US </button>
                </div>
                <div id="loginPanel" class="loginPanel">
                    <p id="loginPanelTextDisplay" class="loginPanelTextDisplay"> Viewing as guest </p><br>
                    <button id="loginButton" class="loginButton" onclick="toggleOverlayVisibility(document.getElementById('loginFormOverlay'))"> Login </button>
                </div>

                
            </div>
            {% block pageContentBlock %}
            {% endblock pageContentBlock %}
        </div>
        <div class="pageSidebar"> </div>
    </div>
</body>

<footer>
    <script type="text/javascript">
        
        
        const cookies = retrieveCookies();
        const username = cookies["USERNAME"];
        if (username != undefined)
        {            
            var logUserButton = document.getElementById("loginButton"); logUserButton.onclick = () => {location.href="/logout";}; logUserButton.textContent = "Logout";
            var usernameContainer = document.getElementById("loginPanelTextDisplay"); usernameContainer.textContent = "Logged in as " + username;
        }

    </script>

{% block footerBlock %}

{% endblock footerBlock %}

</footer>

</html>
